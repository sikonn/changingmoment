---
const platform = "mastodon";
const username = "food";
const startDate = new Date("2022-04-27");
const today = new Date();
const diffDays = Math.floor((today.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));

// 读取 /src/pages/posts 下的所有 .md
const modMap = import.meta.glob('../pages/posts/**/*.md', { eager: true });

// 取出模块数组
const mods = Object.values(modMap) as any[];

// 累加 frontmatter.wordCount（没有就当 0）
const totalWordCount = mods.reduce((sum, m) => {
  const fm = m?.frontmatter ?? {};
  const wc = Number(fm.wordCount ?? 0);
  return sum + (Number.isFinite(wc) ? wc : 0);
}, 0);

const formattedWordCount = (totalWordCount / 1000).toFixed(1) + 'k';
---

<style>
  footer { display: flex; flex-direction: column; margin-top: 1.5rem; text-align: right; }
  footer p { margin: 0.2rem 0; font-size: 0.85rem; }
</style>

<footer>
  <p>2022–2025｜all rights reserved｜嘟嘟了 {formattedWordCount} 字｜{diffDays} days!</p>
</footer>