---
// components/MusicPlayer.astro
---

<div id="musicToggle">
    <img
      src="https://res.stelpolva.moe/stpv/615a661f-3b7c-4ba9-b29a-f1b8eee13979.apng"
      alt="Toggle Music"
      width="73"
      height="85"
    />
  </div>
  
  <audio id="audioPlayer" preload="auto"></audio>
  
  <script>
    const audioPlayer = document.getElementById('audioPlayer');
    const musicToggle = document.getElementById('musicToggle');
    const totalTracks = 50;
  
    // âœ… éšæœºé€‰ä¸€é¦–
    let currentTrack = Math.floor(Math.random() * totalTracks) + 1;
    audioPlayer.src = `/music/music${currentTrack}.m4a`;
  
    let clickCount = 0;
    let clickTimer;
  
    function playRandomTrack() {
      currentTrack = Math.floor(Math.random() * totalTracks) + 1;
      audioPlayer.src = `/music/music${currentTrack}.m4a`;
      audioPlayer.play();
    }
  
    musicToggle.addEventListener('click', () => {
      clickCount++;
      clearTimeout(clickTimer);
  
      clickTimer = setTimeout(() => {
        if (clickCount === 1) {
          audioPlayer.play(); // â–¶ï¸ ç¬¬ä¸€æ¬¡ç‚¹å‡»ï¼šæ’­æ”¾å½“å‰æ­Œæ›²
        } else if (clickCount === 2) {
          audioPlayer.pause(); // â¸ï¸ ç¬¬äºŒæ¬¡ç‚¹å‡»ï¼šæš‚åœ
        } else if (clickCount === 3) {
          playRandomTrack(); // ğŸ”€ ç¬¬ä¸‰æ¬¡ç‚¹å‡»ï¼šéšæœºæ’­æ”¾ä¸‹ä¸€é¦–
        }
        clickCount = 0;
      }, 300);
    });
  
    audioPlayer.addEventListener('ended', () => {
      playRandomTrack(); // æ’­æ”¾ç»“æŸåè‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–éšæœºæ›²
    });
  </script>
  